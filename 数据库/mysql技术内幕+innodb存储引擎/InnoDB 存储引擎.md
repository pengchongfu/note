# 第2章

缓存池中数据页类型：索引页、数据页、undo页、插入缓冲、自适应哈希索引、锁信息、数据字典信息

如何管理缓冲池的内存区域？
- 改进的 LRU 算法
- LRU 列表中的页修改后称为脏页，会放到 Flush 列表中
- redo 日志缓冲
    - 每秒写到文件中
    - 事务提交时
    - 缓冲池过半

事务提交 -> 写 redo 日志文件 -> 再修改页（满足了 ACID 中的 D）

检查点：宕机之后，不需要重做所有日志，因为检查点之前的页都已经写到磁盘
- sharp checkpoint 数据库关闭时，写所有脏页
- fuzzy checkpoint 写部分脏页

InnoDB 关键特性
- 插入缓存
    - 聚集索引：物理顺序
    - B+ 数的特性导致非聚集索引的离散性
    - 开创性：非聚集索引在缓存池中则插入，不在则放入插入缓存（避免磁盘 IO），之后再以一定的频率插入到索引中
        1. 索引是辅助索引
        2. 索引不是唯一（如果是唯一的话，需要离散读磁盘来判断唯一性）
- 两次写
- 自适应哈希索引：相同的访问模式时会自动建立索引
- 异步 IO
    1. 不需要阻塞进程，尽快将IO任务交给系统
    2. 可以IO Merge
    3. Native AIO 操作系统支持
- 刷新邻接页：刷新一个页时把领接的脏页也调用 AIO 写入磁盘（固态硬盘建议关闭）