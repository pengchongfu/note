## 5.1 引言

- 时间局部性：某个数据项在访问之后很可能很快再次被访问
- 空间局部性：地址相邻

## 5.2 存储器技术

SRAM-DRAM-闪存-磁盘

- SRAM：只要加电就能保持数据
- DRAM：在电容上保持电荷，需要周期性刷新（读出并写回）
- 闪存：只读存储器（会损耗）

## 5.3 cache 的基本原理

直接映射，实现原理也是类似于哈希表：
- 8块cache，对地址mod8，可对应到8块cache上
- cache中保存完整的地址，以判断是命中还是缺失

## 5.4 cache 性能的评估与改进

直接映射存储器的任何一块都映射到固定位置

全相联：可以放到任何位置，缺点是需要检索所有项

直接映射与全相联之前的是组相联：
每个块对应唯一组，可以放在组内的任意位置

替换时也是采用LRU算法

采用多级 cache

写代码时提高时间局部性

## 5.5 可信存储器层次

冗余的方式，汉明纠错码

## 5.6 虚拟机

## 5.7 虚拟存储器

就是虚拟内存

TLB软硬件的实现差别不大，TLB其实是页表的缓存

## 5.8 存储器层次结构的一般框架

1. 一个块可以被放在何处
2. 如何找到一个块
3. cache 缺失时替换哪一块
    - 随机替换算法或者近似LRU
4. 写操作如何处理
    - 写直达
    - 写回

## 5.9 使用有限状态机来控制简单的 cache

## 5.10 并行与存储器层次结构：cache 一致性

提供迁移和复制
- 迁移：数据项移入本地 cache
- 复制：读取共享数据时，cache 在本地对数据项做了备份

维护多个处理器一致性的协议：cache 一致性协议

监听协议：独占协议确保了写操作执行时不存在其他可读或者可写的数据项副本
    - 不同变量位于同一块，其实没有共享，称为假共享

## 5.11 并行与存储器层次结构：冗余廉价磁盘阵列
RAID

## 5.12 高级内容：实现 cache 控制器

## 5.13 实例

## 5.14 cache 分块和矩阵乘法


